#pragma once

#include "cuda/typedef.cuh"

#include <string>
#include <string_view>
#include <map>

namespace PHOENIX::Iterator {

struct Config {
    std::string_view name;
    uint32_t k_max;
    uint32_t halo_size;
    bool fixed_timestep{ true };
    bool implemented{ false };
    std::string_view butcher_tableau;
};

/**
 * Butcher Tableaus follow layout
 * c1 | a11 a12 ... a1s
 * c2 | a21 a22 ... a2s
 * ...
 * cs | as1 as2 ... ass
 * --------------------
 *      b1  b2  ... bs
 */

static constexpr Config NEWTON = {
    .name = "Newton's method",
    .k_max = 1,
    .halo_size = 1,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0 | 0.0\n"
        "     -------------\n"
        "         | 1.0",
};

static constexpr Config MP = {
    .name = "Explicit Midpoint method",
    .k_max = 2,
    .halo_size = 2,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0 | 0.0 0.0\n"
        "     0.5 | 0.5 0.0\n"
        "     -------------\n"
        "         | 0.0 1.0",
};

static constexpr Config HEUN = {
    .name = "Heun's method",
    .k_max = 2,
    .halo_size = 2,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0 | 0.0 0.0\n"
        "     1.0 | 1.0 0.0\n"
        "     -------------\n"
        "         | 0.5 0.5",
};

static constexpr Config RALSTON = {
    .name = "Ralston's method",
    .k_max = 2,
    .halo_size = 2,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0     | 0.0     0.0    \n"
        "     2.0/3.0 | 2.0/3.0 0.0    \n"
        "     -------------------------\n"
        "             | 1.0/4.0 3.0/4.0",
};

static constexpr Config KUTTA3 = {
    .name = "Runge Kutta 3",
    .k_max = 3,
    .halo_size = 3,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0     |  0.0     0.0     0.0    \n"
        "     1.0/2.0 |  1.0/2.0 0.0     0.0    \n"
        "     1.0     | -1.0     2.0     0.0    \n"
        "     ----------------------------------\n"
        "             |  1.0/6.0 2.0/3.0 1.0/6.0",
};

static constexpr Config HEUN3 = {
    .name = "Heun's third-order method",
    .k_max = 3,
    .halo_size = 3,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0     | 0.0     0.0     0.0\n"
        "     1.0/3.0 | 1.0/3.0 0.0     0.0\n"
        "     2.0/3.0 | 0.0     2.0/3.0 0.0\n"
        "     -----------------------------\n"
        "             | 1.0/4.0 0.0 3.0/4.0",
};

static constexpr Config RALSTON3 = {
    .name = "Ralston's third-order method",
    .k_max = 3,
    .halo_size = 3,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0     | 0.0     0.0     0.0    \n"
        "     1.0/2.0 | 1.0/2.0 0.0     0.0    \n"
        "     3.0/4.0 | 0.0     3.0/4.0 0.0    \n"
        "     ---------------------------------\n"
        "             | 2.0/9.0 1.0/3.0 4.0/9.0",
};

static constexpr Config VHW = {
    .name = "Van der Houwen's/Wray's third-order method",
    .k_max = 3,
    .halo_size = 3,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0      | 0.0      0.0      0.0    \n"
        "     8.0/15.0 | 8.0/15.0 0.0      0.0    \n"
        "     2.0/3.0  | 1.0/4.0  5.0/12.0 0.0    \n"
        "     ------------------------------------\n"
        "     0.0      | 1.0/4.0  0.0      3.0/4.0",

};

static constexpr Config SSPRK3 = {
    .name = "Strong Stability Preserving Runge Kutta 3",
    .k_max = 3,
    .halo_size = 3,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0 |  0.0     0.0     0.0    \n"
        "     1.0 |  1.0     0.0     0.0    \n"
        "     1.0 |  1.0/4.0 1.0/4.0 0.0    \n"
        "     ------------------------------\n"
        "         |  1.0/6.0 1.0/6.0 2.0/3.0",
};

static constexpr Config BOGACKI = {
    .name = "Bogacki-Shampine 3",
    .k_max = 3,
    .halo_size = 3,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0     | 0.0     0.0     0.0    \n"
        "     1.0/2.0 | 1.0/2.0 0.0     0.0    \n"
        "     3.0/4.0 | 0.0     3.0/4.0 0.0    \n"
        "     ---------------------------------\n"
        "             | 2.0/9.0 1.0/3.0 4.0/9.0",
};

static constexpr Config BOGACKI_VAR = {
    .name = "Bogacki-Shampine 3(2)",
    .k_max = 4,
    .halo_size = 4,
    .fixed_timestep = false,
    .implemented = true,
    .butcher_tableau =

        "     0.0     | 0.0     0.0     0.0      0.0    \n"
        "     1.0/2.0 | 1.0/2.0 0.0     0.0      0.0    \n"
        "     3.0/4.0 | 0.0     3.0/4.0 0.0      0.0    \n"
        "     ------------------------------------------\n"
        "             | 2.0/9.0 1.0/3.0 4.0/9.0  0.0    \n"
        "             | 7.0/24.0 1.0/4.0 1.0/3.0 1.0/8.0",
};

static constexpr Config RK4 = {
    .name = "Runge Kutta 4",
    .k_max = 4,
    .halo_size = 4,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0 | 0.0     0.0     0.0     0.0    \n"
        "     0.5 | 0.5     0.0     0.0     0.0    \n"
        "     0.5 | 0.0     0.5     0.0     0.0    \n"
        "     1.0 | 0.0     0.0     1.0     0.0    \n"
        "     -------------------------------------\n"
        "     0.0 | 1.0/6.0 1.0/3.0 1.0/3.0 1.0/6.0",
};

static constexpr Config RALSTON4 = {
    .name = "Ralston's fourth-order method",
    .k_max = 4,
    .halo_size = 4,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0           | 0.0            0.0           0.0           0.0          \n"
        "     0.4           | 0.4            0.0           0.0           0.0          \n"
        "     0.51823725421 | 0.29697760924  0.15875964497 0.0           0.0          \n"
        "     0.51823725421 | 0.21810038822 -3.05096514869 3.83286476047 0.0          \n"
        "     ------------------------------------------------------------------------\n"
        "                   | 0.17476028226 -0.55148066287 1.2055355994  0.17118478122",
};

static constexpr Config RULE38 = {
    .name = "Runge-Kutta 3/8",
    .k_max = 4,
    .halo_size = 4,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0     |  0.0      0.0 0.0  0.0 \n"
        "     1.0/3.0 |  1.0/3.0  0.0 0.0  0.0 \n"
        "     2.0/3.0 | -1.0/3.0  1.0 0.0  0.0 \n"
        "     1.0     |  1.0     -1.0 1.0  0.0 \n"
        "     ---------------------------------\n"
        "             |  1/8      3/8 3/8  1/8",
};

static constexpr Config NYSTROEM = {
    .name = "Nystroem's fifth-order method",
    .k_max = 6,
    .halo_size = 6,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =

        "     0.0     | 0.0        0.0       0.0         0.0      0.0       0.0        \n"
        "     1.0/3.0 | 1.0/3.0    0.0       0.0         0.0      0.0       0.0        \n"
        "     2.0/5.0 | 4.0/25.0   6.0/25.0  0.0         0.0      0.0       0.0        \n"
        "     1.0     | 1.0/4.0   -3.0       15.0/4.0    0.0      0.0       0.0        \n"
        "     2.0/3.0 | 2.0/27.0   10.0/9.0 -50.0/81.0   8.0/81.0 0.0       0.0        \n"
        "     4.0/5.0 | 2.0/25.0   12.0/25.0 2.0/15.0    8.0/75.0 0.0       0.0        \n"
        "     -------------------------------------------------------------------------\n"
        "             | 23.0/192.0 0.0       125.0/192.0 0.0     -27.0/64.0 125.0/192.0",
};

static constexpr Config DP5FIXED = {
    .name = "Dormand–Prince 5",
    .k_max = 6,
    .halo_size = 6,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0      | 0.0          0.0         0.0          0.0       0.0         0.0\n"
        "     1.0/5.0  | 1.0/5.0      0.0         0.0          0.0       0.0         0.0\n"
        "     3.0/10.0 | 3.0/40.0     9.0/40.0    0.0          0.0       0.0         0.0\n"
        "     4.0/5.0  | 44.0/45.0   -56.0/15.0   32.0/9.0     0.0       0.0         0.0\n"
        "     8.0/9    | 19372./6561 -25360./2187 64448./6561 -212./729  0.0         0.0\n"
        "     1.0      | 9017./3168  -355./33     46732./5247  49./176  -5103./18656 0.0\n"
        "     -----------------------------------------------------------------------------\n"
        "              | 35./384      0.0         500./1113    125./192 -2187./6784  11./84",
};

static constexpr Config DP5VAR = {
    .name = "Dormand–Prince 5(4)",
    .k_max = 7,
    .halo_size = 7,
    .fixed_timestep = false,
    .implemented = true,
    .butcher_tableau =
        "     0.0      | 0.0          0.0         0.0          0.0       0.0           0.0        0.0     \n"
        "     1.0/5.0  | 1.0/5.0      0.0         0.0          0.0       0.0           0.0        0.0     \n"
        "     3.0/10.0 | 3.0/40.0     9.0/40.0    0.0          0.0       0.0           0.0        0.0     \n"
        "     4.0/5.0  | 44.0/45.0   -56.0/15.0   32.0/9.0     0.0       0.0           0.0        0.0     \n"
        "     8.0/9    | 19372./6561 -25360./2187 64448./6561 -212./729  0.0           0.0        0.0     \n"
        "     1.0      | 9017./3168  -355./33     46732./5247  49./176  -5103./18656   0.0        0.0     \n"
        "     1.0      | 35./384      0.0         500./1113    125./192 -2187./6784    11./84     0.0     \n"
        "     --------------------------------------------------------------------------------------------\n"
        "              | 35./384      0.0         500./1113    125./192 -2187./6784    11./84     0.0     \n"
        "              | 5179./57600  0.0         7571./16695  393./640 -92097./339200 187./2100  1.0/40.0",
};

static constexpr Config CASHKARPF = {
    .name = "Cash-Karp 5",
    .k_max = 6,
    .halo_size = 6,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0      | 0.0          0.0         0.0          0.0            0.0        0.0\n"
        "     1.0/5.0  | 1.0/5.0      0.0         0.0          0.0            0.0        0.0\n"
        "     3.0/10.0 | 3.0/40.0     9.0/40.0    0.0          0.0            0.0        0.0\n"
        "     3.0/5.0  | 3.0/10.0    -9.0/10.0    6.0/5.0      0.0            0.0        0.0\n"
        "     1.0      | -11.0/54.0   5.0/2.0    -70.0/27.0    35.0/27.0      0.0        0.0\n"
        "     7.0/8.0  | 1631./55296  175./512    575./13824   44275./110592  253./4096  0.0\n"
        "     -------------------------------------------------------------------------------\n"
        "              | 37.0/378    0.0         250./621    125./594 -11./84        0.0        0.0",
};

static constexpr Config CASHKARP = {
    .name = "Cash-Karp 45",
    .k_max = 6,
    .halo_size = 6,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0      | 0.0          0.0         0.0          0.0            0.0        0.0\n"
        "     1.0/5.0  | 1.0/5.0      0.0         0.0          0.0            0.0        0.0\n"
        "     3.0/10.0 | 3.0/40.0     9.0/40.0    0.0          0.0            0.0        0.0\n"
        "     3.0/5.0  | 3.0/10.0    -9.0/10.0    6.0/5.0      0.0            0.0        0.0\n"
        "     1.0      | -11.0/54.0   5.0/2.0    -70.0/27.0    35.0/27.0      0.0        0.0\n"
        "     7.0/8.0  | 1631./55296  175./512    575./13824   44275./110592  253./4096  0.0\n"
        "     -------------------------------------------------------------------------------\n"
        "              | 37.0/378    0.0         250./621    125./594 -11./84        0.0        0.0\n"
        "              | 2825./27648 0.0         18575./48384 135./384 -2187./6784    11./84     0.0",

};

static constexpr Config FEHLBERG2 = {
    .name = "Fehlberg 2",
    .k_max = 3,
    .halo_size = 3,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0     | 0.0     0.0         0.0\n"
        "     1.0/2.0 | 1.0/2.0 0.0         0.0\n"
        "     1.0     | 1.0/256 255.0/256.0 0.0\n"
        "     ---------------------------------------\n"
        "             | 1.0/512 255.0/256   1.0/512.0",
};

static constexpr Config FEHLBERG2_VAR = {
    .name = "Fehlberg 2",
    .k_max = 3,
    .halo_size = 3,
    .fixed_timestep = false,
    .implemented = true,
    .butcher_tableau =
        "     0.0     | 0.0     0.0         0.0\n"
        "     1.0/2.0 | 1.0/2.0 0.0         0.0\n"
        "     1.0     | 1.0/256 255.0/256.0 0.0\n"
        "     ---------------------------------------\n"
        "             | 1.0/512 255.0/256   1.0/512.0\n"
        "             | 1.0/256 255.0/256   0.0      ",
};

static constexpr Config FEHLBERG = {
    .name = "Fehlberg 5",
    .k_max = 6,
    .halo_size = 6,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0      |  0.0          0.0            0.0            0.0           0.0       0.0     \n"
        "     1.0/4.0  |  1.0/4.0      0.0            0.0            0.0           0.0       0.0     \n"
        "     3.0/8.0  |  3.0/32.0     9.0/32.0       0.0            0.0           0.0       0.0     \n"
        "     12./13   |  1932.0/2197 -7200.0/2197.0 -7296.0/2197.0  0.0           0.0       0.0     \n"
        "     1.0      |  439.0/216.0 -8.0            3680.0/513.0  -845./4104.0   0.0       0.0     \n"
        "     1.0/2.0  | -8.0/27.0     2.0           -3544.0/2565.0  1859./4104.0 -11.0/40.0 0.0     \n"
        "     ---------------------------------------------------------------------------------------\n"
        "              |  16.0/135.0   0.0            6656./12825    28561./56430 -9.0/50.0  2.0/55.0",
};

static constexpr Config FEHLBERG_VAR = {
    .name = "Fehlberg 5(4)",
    .k_max = 6,
    .halo_size = 6,
    .fixed_timestep = false,
    .implemented = true,
    .butcher_tableau =
        "     0.0      |  0.0          0.0            0.0            0.0           0.0       0.0     \n"
        "     1.0/4.0  |  1.0/4.0      0.0            0.0            0.0           0.0       0.0     \n"
        "     3.0/8.0  |  3.0/32.0     9.0/32.0       0.0            0.0           0.0       0.0     \n"
        "     12./13   |  1932.0/2197 -7200.0/2197.0 -7296.0/2197.0  0.0           0.0       0.0     \n"
        "     1.0      |  439.0/216.0 -8.0            3680.0/513.0  -845./4104.0   0.0       0.0     \n"
        "     1.0/2.0  | -8.0/27.0     2.0           -3544.0/2565.0  1859./4104.0 -11.0/40.0 0.0     \n"
        "     ---------------------------------------------------------------------------------------\n"
        "              |  16.0/135.0   0.0            6656./12825    28561./56430 -9.0/50.0  2.0/55.0\n"
        "              |  25.0/216.0   0.0            1408./2565.0   2197./4104.0 -1.0/5.0   0.0     \n",
};

static constexpr Config DOP853 = {
    .name = "Dormand–Prince 8",
    .k_max = 12,
    .halo_size = 12,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0           |  0.0           0.0            0.0            0.0           0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.05260015196 |  0.05260015196 0.0            0.0            0.0           0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.07890022794 |  0.01972505698 0.05917517095  0.0            0.0           0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.1183503419  |  0.02958758548 0.0            0.08876275643  0.0           0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.2816496581  |  0.2413651342  0.0           -0.8845494793   0.9248340033  0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.3333333333  |  0.03703703704 0.0            0.0            0.1708286087  0.1254676876   0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.25          |  0.03710937500 0.0            0.0            0.1702522110  0.06021653898 -0.01757812500  0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.3076923077  |  0.03709200012 0.0            0.0            0.1703839257  0.1072620304  -0.01531943775  0.008273789164  0.0          0.0             0.0            0.0           0.0\n"
        "     0.6512820513  |  0.6241109587  0.0            0.0           -3.360892629  -0.8682193468   27.592099699   20.15406755    -43.48988418  0.0             0.0            0.0           0.0\n"
        "     0.6           |  0.4776625364  0.0            0.0           -2.488114620  -0.5902908268   21.23005145    15.27923363    -33.28821097  -0.02033120171  0.0            0.0           0.0\n"
        "     0.8571428571  | -0.9371424301  0.0            0.0            5.186372429   1.091437349   -8.149787011   -18.52006566     22.73948710   2.493605553   -3.046764472    0.0           0.0\n"
        "     1.0           |  2.273310148   0.0            0.0           -10.534495467 -2.000872058   -17.958931863   27.94888453    -2.858998277  -8.872856934    12.36056718    0.643392746   0.0\n"
        "     ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n"
        "     0.0           |  0.0542937341  0.0            0.0            0.0           0.0            4.450312893    1.891517899    -5.801203960   0.311164367    -0.1521609497  0.2013654008  0.04471061573",
};

static constexpr Config DOP853_VAR = {
    .name = "Dormand–Prince 8(5)",
    .k_max = 12,
    .halo_size = 12,
    .fixed_timestep = false,
    .implemented = true,
    .butcher_tableau =
        "     0.0           |  0.0           0.0            0.0            0.0           0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.05260015196 |  0.05260015196 0.0            0.0            0.0           0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.07890022794 |  0.01972505698 0.05917517095  0.0            0.0           0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.1183503419  |  0.02958758548 0.0            0.08876275643  0.0           0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.2816496581  |  0.2413651342  0.0           -0.8845494793   0.9248340033  0.0            0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.3333333333  |  0.03703703704 0.0            0.0            0.1708286087  0.1254676876   0.0            0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.25          |  0.03710937500 0.0            0.0            0.1702522110  0.06021653898 -0.01757812500  0.0             0.0          0.0             0.0            0.0           0.0\n"
        "     0.3076923077  |  0.03709200012 0.0            0.0            0.1703839257  0.1072620304  -0.01531943775  0.008273789164  0.0          0.0             0.0            0.0           0.0\n"
        "     0.6512820513  |  0.6241109587  0.0            0.0           -3.360892629  -0.8682193468   27.592099699   20.15406755    -43.48988418  0.0             0.0            0.0           0.0\n"
        "     0.6           |  0.4776625364  0.0            0.0           -2.488114620  -0.5902908268   21.23005145    15.27923363    -33.28821097  -0.02033120171  0.0            0.0           0.0\n"
        "     0.8571428571  | -0.9371424301  0.0            0.0            5.186372429   1.091437349   -8.149787011   -18.52006566     22.73948710   2.493605553   -3.046764472    0.0           0.0\n"
        "     1.0           |  2.273310148   0.0            0.0           -10.534495467 -2.000872058   -17.958931863   27.94888453    -2.858998277  -8.872856934    12.36056718    0.643392746   0.0\n"
        "     ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n"
        "     0.0           |  0.0542937341  0.0            0.0            0.0           0.0            4.450312893    1.891517899    -5.801203960   0.311164367    -0.1521609497  0.2013654008  0.04471061573\n"
        "     0.0           |  0.0131200449  0.0            0.0            0.0           0.0           -1.225156446   -0.4957589       1.664377182  -0.350328848     0.3341791187  0.0819232064 -0.02235530786",
};

static constexpr Config NSRK78 = {
    .name = "Nullspace RK 13-stage 8",
    .k_max = 13,
    .halo_size = 13,
    .fixed_timestep = true,
    .implemented = true,
    .butcher_tableau =
        "     0.0000000000 |  0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.0010000000 |  0.0010000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.1111111111 | -6.0617283951   6.1728395062   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.1666666667 |  0.0416666667   0.0000000000   0.1250000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.4166666667 |  0.4166666667   0.0000000000  -1.5625000000   1.5625000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.5000000000 |  0.0500000000   0.0000000000   0.0000000000   0.2500000000   0.2000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.8333333333 | -0.2388888889   0.0000000000   0.0000000000   1.1759259259  -2.4370370370   2.3333333333   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.1666666667 |  0.1162338743   0.0000000000   0.0000000000  -0.0393757809   0.3685158355  -0.2975124289   0.0187245206   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.6666666667 |  2.1734498543   0.0000000000   0.0000000000  -9.3383270911  16.797003740   -12.745269926   0.7872659176   3.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.7600000000 |  1.9039834510   0.0000000000   0.0000000000 -17.571184052   16.652296555   -1.7433454667   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.8400000000 | -0.5511703561   0.0000000000   0.0000000000   3.185331936   -0.2855556672   0.0171531722   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     1.0000000000 |  6.1621824455   0.0000000000   0.0000000000 -48.523639644   43.594126382   -8.7726603850   4.7662059749  21.5986868330   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     1.0000000000 | -0.7017567853   0.0000000000   0.0000000000   8.213371203   -5.0177318283   4.2147151770   0.7831613949   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n"
        "     0.0000000000 |  0.0480839002   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.2244210495  -0.5351902593   0.0019833607  -0.4089591837   1.0874653481   4.9604127002   0.0367460317   0.0000000000",
};

static constexpr Config NSRK78_VAR = {
    .name = "Nullspace RK 13-stage 8(7)",
    .k_max = 13,
    .halo_size = 13,
    .fixed_timestep = false,
    .implemented = true,
    .butcher_tableau =
        "     0.0000000000 |  0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.0010000000 |  0.0010000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.1111111111 | -6.0617283951   6.1728395062   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.1666666667 |  0.0416666667   0.0000000000   0.1250000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.4166666667 |  0.4166666667   0.0000000000  -1.5625000000   1.5625000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.5000000000 |  0.0500000000   0.0000000000   0.0000000000   0.2500000000   0.2000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.8333333333 | -0.2388888889   0.0000000000   0.0000000000   1.1759259259  -2.4370370370   2.3333333333   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.1666666667 |  0.1162338743   0.0000000000   0.0000000000  -0.0393757809   0.3685158355  -0.2975124289   0.0187245206   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.6666666667 |  2.1734498543   0.0000000000   0.0000000000  -9.3383270911  16.797003740   -12.745269926   0.7872659176   3.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.7600000000 |  1.9039834510   0.0000000000   0.0000000000 -17.571184052   16.652296555   -1.7433454667   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     0.8400000000 | -0.5511703561   0.0000000000   0.0000000000   3.185331936   -0.2855556672   0.0171531722   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     1.0000000000 |  6.1621824455   0.0000000000   0.0000000000 -48.523639644   43.594126382   -8.7726603850   4.7662059749  21.5986868330   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     1.0000000000 | -0.7017567853   0.0000000000   0.0000000000   8.213371203   -5.0177318283   4.2147151770   0.7831613949   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.0000000000\n"
        "     ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n"
        "     0.0000000000 |  0.0480839002   0.0000000000   0.0000000000   0.0000000000   0.0000000000   0.2244210495  -0.5351902593   0.0019833607  -0.4089591837   1.0874653481   4.9604127002   0.0367460317   0.0000000000\n"
        "     0.0000000000 |  0.0475737777   0.0000000000   0.0000000000   0.0000000000   0.0000000000  -0.3944056160  -0.1024398854   0.6720897649  -0.2217897037   0.0000000000   0.0000000000   0.0000000000   0.0526190476",
};

inline const std::map<std::string, Config> available = {
    {
        "Newton",
        NEWTON,
    },
    {
        "MP",
        MP,
    },
    {
        "Heun",
        HEUN,
    },
    {
        "Ralston",
        RALSTON,
    },
    {
        "RK3",
        KUTTA3,
    },
    {
        "Heun3",
        HEUN3,
    },
    {
        "Ralston3",
        RALSTON3,
    },
    {
        "VHW",
        VHW,
    },
    {
        "RK4",
        RK4,
    },
    {
        "Ralston4",
        RALSTON4,
    },
    {
        "SSPRK3",
        SSPRK3,
    },
    {
        "rule38",
        RULE38,
    },
    {
        "Nystroem",
        NYSTROEM,
    },
    {
        "DP8",
        DOP853,
    },
    {
        "CashKarp5",
        CASHKARPF,
    },
    {
        "CashKarp45",
        CASHKARP,
    },
    {
        "DP5",
        DP5FIXED,
    },
    {
        "Fehlberg5",
        FEHLBERG,
    },
    {
        "Bogacki3",
        BOGACKI,
    },
    {
        "Bogacki23",
        BOGACKI_VAR,
    },
    {
        "Fehlberg2",
        FEHLBERG2,
    },
    {
        "Fehlberg45",
        FEHLBERG_VAR,
    },
    {
        "DP85",
        DOP853_VAR,
    },
    {
        "Fehlberg12",
        FEHLBERG2_VAR,
    },
    {
        "NSRK8",
        NSRK78,
    },
    {
        "NSRK78",
        NSRK78_VAR,
    },
    {
        "DP45",
        DP5VAR,
    },

};
} // namespace PHOENIX::Iterator